{{- if .Values.cloudflareTunnel.enabled }}
{{- if not .Values.cloudflareTunnel.credentials.useExistingSecret }}
# NOTE: This is a SealedSecret - the encrypted tunnel token
# To create/update:
# 1. Get tunnel token from Cloudflare Zero Trust dashboard
# 2. Create sealed secret:
#    echo -n 'YOUR_TOKEN' | kubectl create secret generic cloudflare-tunnel-secret \
#      --dry-run=client -o yaml --from-file=tunnel-token=/dev/stdin \
#      -n cloudflare-tunnel | \
#    kubeseal --controller-name=sealed-secrets --controller-namespace=kube-system \
#      -o yaml > infra/templates/cloudflare-tunnel/secret.yaml
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: {{ .Values.cloudflareTunnel.credentials.secretName }}
  namespace: {{ .Values.cloudflareTunnel.namespace }}
spec:
  encryptedData:
    tunnel-token: AgBSIaLMs09KUIn0pY+s9XNmQNijVK6wCv6P4wOxwj7kR4IozoFLf9Wn7B7tE0ez55cyfkdZGHfgcw5ADHDqmfv2gF+bAMDMfKUhSRAxY6RDyGcFUPBwP8IxW6IBbyq4nhQSu0qmuIlzLpxDGzND/qxoVbZj7srrRjYjmrTjxXfVM5M7nw3+H4lHLpOwDJFSgXIM36XduusV4CR5Nl6aXeopWzg0ELFftB+JLtYEA0313qcsXR4XFFYOhP6Pqc2StC1X2vsl3Q17eBZvMzrYjbwTdnHoesxg8MHl1uKAdtpgHX6I3A44HnxYf2CNBuAvmN1jsJeTmR1L2NfV7sxfRVY9UFuYDw0AiiCHv+5XS4h2h78C7w+rwHv0LSncyEBqB9UUzCh7TGyv0WgjZp89rlaYzBHnFtFVHJlPiuNC4STBLLL6drK25A4WMOLpC3Jzg2LWOs+vwhu4ZKgL8lbse3JrKhFw6oASZ0dek6ZSHGs8HEnVRmZlRIuXakVCa+LasyXvS/a4F58u3bIvgWDQY8BzDuptUkfSe04pJ+tN8annmcxwbUzK8gfgxNYzSlZWv8z63pLunlEx4I7TWo9hMBiEzegqyt9/gJ+PBKNg0A3I0nrPfKSmTeh0hxfG0GpgI7afZbtMrkjFSvWYqpT5ArfMwsSGHv0RCalzOjQ8VbjxkqkQ+0LcHcnza+vyhTw5BJTWy/1dXLrt6Qkwut252Ut1D8iVop47K/3vfD08FSbrcI+aLcPxdL9wRqr+9mJm2dImS6b5Q5UvmJ4GRZvjbp+shpFt0qonF+EA5yr0dOf50/Ri/8MbUXBCtYqPCE2ZXv1hFDhczdPgcZRnGr8RI9Ug1jxvs3jcREXyybeUUpkJjwI3+uNgrxYdM36CaIlL2mo8+3NREYs4GTTs6OWEyaNyBLLX0JnoMASRtOVSV98oxL2wPdZLz4Fv
  template:
    metadata:
      name: {{ .Values.cloudflareTunnel.credentials.secretName }}
      namespace: {{ .Values.cloudflareTunnel.namespace }}
{{- end }}
{{- end }}
